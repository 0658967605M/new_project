{% extends "base.html" %}

{% block content %}

<h2>{{ role|title }} Dashboard</h2>

{% if role == "reader" %}

    {% for article in articles %}
        <div style="margin-bottom:25px; padding:15px; border:1px solid #ddd; border-radius:5px;">

            <!-- Article Title -->
            <h3>{{ article.title }}</h3>

            <!-- Read Button -->
            <a href="{% url 'read_article' article.id %}">
                Read Article
            </a>

            <br><br>

            <!-- ====================== -->
            <!-- Journalist Subscription -->
            <!-- ====================== -->
            {% if article.created_by.role == "journalist" %}
                {% if article.created_by.id in subscribed_journalists %}
                    <a href="{% url 'unsubscribe_journalist' article.created_by.id %}"
                       style="color:rgb(236, 8, 8);">
                        Unsubscribe from {{ article.created_by.username }}
                    </a>
                {% else %}
                    <a href="{% url 'subscribe_journalist' article.created_by.id %}">
                        Subscribe to {{ article.created_by.username }}
                    </a>
                {% endif %}
                <br><br>
            {% endif %}

            <!-- ====================== -->
            <!-- Publisher Subscription -->
            <!-- ====================== -->
            {% if article.publisher %}
                {% if article.publisher.id in subscribed_publishers %}
                    <a href="{% url 'unsubscribe_publisher' article.publisher.id %}"
                       style="color:rgb(240, 3, 3)(10, 10, 10);">
                        Unsubscribe from {{ article.publisher.name }}
                    </a>
                {% else %}
                    <a href="{% url 'subscribe_publisher' article.publisher.id %}">
                        Subscribe to {{ article.publisher.name }}
                    </a>
                {% endif %}
            {% endif %}

        </div>

    {% empty %}
        <p>No approved articles available.</p>
    {% endfor %}


{% elif role == "journalist" %}
    <a href="{% url 'create_article' %}">Create Article</a>
    {% for article in articles %}
        <p>
            {{ article.title }}
            <a href="{% url 'read_article' article.id %}">Read</a>
            <a href="{% url 'update_article' article.id %}">Update</a>
            <a href="{% url 'delete_article' article.id %}">Delete</a>
        </p>
    {% empty %}
        <p>No articles.</p>
    {% endfor %}

{% elif role == "editor" %}
    {% for article in articles %}
        <p>
            {{ article.title }}
            <a href="{% url 'approve_article' article.id %}">Approve</a>
            <a href="{% url 'update_article' article.id %}">Update</a>
            <a href="{% url 'delete_article' article.id %}">Delete</a>
        </p>
    {% empty %}
        <p>No pending articles.</p>
    {% endfor %}
{% endif %}
{% endblock %}
